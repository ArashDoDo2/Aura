# Aura
Aura یک راهکار پروکسی هوشمند و فوق‌سبک است که با هدف دور زدن محدودیت‌های شدید اینترنتی، ارتباط متنی واتس‌اپ را از داخل ایران به سرورهای استرالیا برقرار می‌کند. این پروژه بر لایه‌ی انتقال DNS-Based استوار است تا در شرایطی که پروتکل‌های مستقیم مسدود هستند، پایداری خود را حفظ کند.

## معماری کلی
1. کلاینت محلی یک پروکسی TCP ساده را باز می‌کند و داده‌های دریافتی از واتس‌اپ را در قطعاتی تا ۲۴ بایت تقسیم می‌کند.
2. هر قطعه Base32 شده و داخل یک رشته‌ی DNS قرار می‌گیرد که به صورت `<fragment>.<seq>.up.<session>.proxy.aura` به DNS authoritative استرالیا ارسال می‌شود.
3. سرور استرالیا، بسته‌ها را دوباره جمع‌آوری کرده، به زیرساخت رسمی واتس‌اپ فوروارد می‌کند و پاسخ‌ها را در صفی نگاه می‌دارد.
4. هنگام دریافت درخواست DNS جهت داده‌ی downstream (دامنه‌ای با الگو `poll.<seq>.down.<session>.proxy.aura`)، سرور پاسخ‌هایی حاوی داده‌های Base32 شده را داخل رکوردهای AAAA برمی‌گرداند. کلاینت آن‌ها را بازگشت داده و به واتس‌اپ داخل دستگاه می‌رساند.

## ساختار پروژه
- `client/local_proxy.py`: پروکسی محلی که داده‌های واتس‌اپ را به قطعات Base32 تبدیل کرده و از طریق DNS به سرور تونل می‌کند.
- `server/dns_authoritative.py`: یک DNS server ساده که کوئری‌های فرگمنت شده را دریافت، بازسازی و به سرویس WhatsApp فوروارد می‌کند.

## استفاده
**۱. پیکربندی دامنه‌ی DNS**  
دامنه‌ی لایه‌ی Tunnel به صورت `proxy.aura` فرض شده و باید به IP سرور DNS استرالیا/نامه‌گذار آدرسی بدهد. کوئری‌ها و پاسخ‌ها روی پورت UDP ۵۳ رد و بدل می‌شوند.

**۲. اجرا در سمت کلاینت (داخل ایران)**  
```
python3 client/local_proxy.py \
  --listen-port 1080 \
  --remote-dns 203.0.113.10 \
  --domain-root proxy.aura \
  --session-prefix iran
```
واتس‌اپ یا هر پروکسی دیگر را به `localhost:1080` متصل کنید.

**۳. اجرا در سمت سرور (استرالیا)**  
```
python3 server/dns_authoritative.py \
  --host 0.0.0.0 \
  --port 53 \
  --domain-root proxy.aura \
  --whatsapp-host mmg.whatsapp.net \
  --whatsapp-port 443
```

## تنظیمات بیشتر
- `--chunk-size`: حداکثر بایت برای هر فرگمنت (پیش‌فرض 24).  
- `--poll-interval`: هر چند میلی‌ثانیه کلاینت برای دریافت داده‌ی baru درخواست DNS می‌فرستد.  
- `--log-level`: برای فعال/غیرفعال شدن لاگ‌ها از `info`/`debug`.

## ملاحظات امنیتی و عملیاتی
- پیاده‌سازی DNS-Tunneling نیازمند توجه به محدودیت‌های MTU، نرخ و ظرفیت رسیدگی DNS سرور است.  
- کدها برای اهداف آزمایشی طراحی شده‌اند و قبل از استقرار باید در محیط کنترل‌شده تست شوند.
